<html>

<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400|Roboto:300,400,500,700&display=swap"
    rel="stylesheet">

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #F7F8FB;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    h2 {
      margin: 10px 10px 0 10px;
      margin-left: 20px;
    }

    .card {
      margin: 10px 0 20px 0;
      padding: 12px 15px;
      background-color: #FFFFFF;
      border-radius: 4px;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .15);
    }

    .meta-label {
      color: #909090;
      /* padding: 5px 0 0; */
      font-size: 14px;
      margin: 0 10px 0 20px;
    }

    .meta {
      color: #4F4F4F;
      /* padding: 5px 0 0; */
      font-size: 14px;
      margin-right: 20px;
    }

    .map {
      padding: 0;
      margin: 0;
      height: 500px;
      width: 100%;
    }

    #total-active,
    #total-confirmed,
    #total-deaths,
    #total-recovered {
      font-weight: bold;
      font-size: 28px;
    }


    #total-active {
      color: #EB5757;
    }

    #total-confirmed {
      color: #FF7335
    }

    #total-deaths {
      color: #2F80ED;
    }

    #total-recovered {
      color: #27AE60;
    }
  </style>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">


    dataset_url="https://datasource.kapsarc.org/api/records/1.0/search/?dataset=saudi-arabia-coronavirus-disease-covid-19-situation&q=&sort=-date&facet=daily_cumulative&rows=-1&facet=indicator&facet=date&facet=event&facet=region&facet=city&refine.city=Total"
    var records;
    var result_data;
    
    fetch(dataset_url)
      .then(res => res.json())
      .then((out) => {
        records = out["records"];
        var helper = {};
        result_data = records.reduce(function (r, value) {
          var key = value["fields"]["date"];
          var row = value["fields"];

          if (helper[key]) {
            if (helper[key] && helper[key][row["daily_cumulative"]]) {
            helper[key][row["daily_cumulative"]][row["indicator"]]=row;
            } else{

            helper[key][row["daily_cumulative"]]={};
            helper[key][row["daily_cumulative"]][row["indicator"]]=row;

            }
          } else{
            helper[key] = {};
            helper[key][row["daily_cumulative"]]={};
            helper[key][row["daily_cumulative"]][row["indicator"]]=row;
          }
          return helper;
        }, []);

      })
      .catch(err => { throw err });

    google.charts.load('current', { packages: ['corechart', 'line'] });
    google.charts.setOnLoadCallback(drawCurveTypes);




    function drawCurveTypes() {
    
      var last_date = Object.keys(result_data)[Object.keys(result_data).length-1];
      console.log('length ', 90);

      var Total_Confirmed = result_data[last_date]["Cumulative"]["Cases"]["cases"];
      var Total_Active = result_data[last_date]["Cumulative"]["Active cases"]["cases"];
      var Total_Recovered =result_data[last_date]["Cumulative"]["Recoveries"]["cases"]; 
      var Total_Deaths = result_data[last_date]["Cumulative"]["Mortalities"]["cases"]; 

      document.getElementById("total-confirmed").innerHTML = Total_Confirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      document.getElementById("total-active").innerHTML = Total_Active.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      document.getElementById("total-recovered").innerHTML = Total_Recovered.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      document.getElementById("total-deaths").innerHTML = Total_Deaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      var active_percent = (Total_Active * 100 / Total_Confirmed);
      var recovered_percent = (Total_Recovered * 100 / Total_Confirmed);
      var deaths_percent = (Total_Deaths * 100 / Total_Confirmed);

      var active_x2 = active_percent - 2;
      var recovered_x2 = active_x2 + recovered_percent;
      var recovered_x_text = active_x2 + (recovered_percent / 2);

      var deaths_x = recovered_x2;
      var deaths_x_text = (recovered_x2 + (deaths_percent) + 0.5);
      var newSvg = document.getElementById('cases-percentage');
      newSvg.outerHTML += '<svg  width="100%" height="20px" xmlns="http://www.w3.org/2000/svg" version="1.1"><line x1="0" y1="15" x2="' + active_x2 + '%" y2="15" style="stroke-linecap: round;stroke: #EB5757; stroke-width: 12 ;border-radius: 10px;"></line><text x="' + (active_percent / 2) + '%" y="16" dominant-baseline="middle" text-anchor="middle" style="fill: white; font-size:10">' + active_percent.toFixed(1) + '%</text><line x1="' + active_x2 + '%" y1="15" x2="' + (recovered_x2) + '%" y2="15" style="stroke: #27AE60; stroke-width: 12"></line><text x="' + recovered_x_text + '%" y="16" dominant-baseline="middle" text-anchor="middle" style="fill: white; font-size:10">' + recovered_percent.toFixed(1) + '%</text><line x1="' + deaths_x + '%" y1="15" x2="100%" y2="15" style="stroke: #2F80ED; stroke-width: 12"></line><text x="' + deaths_x_text + '%" y="16" dominant-baseline="middle" text-anchor="middle" style="fill: white; font-size:10">' + deaths_percent.toFixed(1) + '%</text></svg>';



      var cumulative_data = [];
      var daily_data = [];


      Object.keys(result_data).forEach(function(date) {

        for (var row in result_data[date]["Cumulative"]) {
          var c = result_data[date]["Cumulative"]["Cases"];
          var a = result_data[date]["Cumulative"]["Active cases"];
          var r = result_data[date]["Cumulative"]["Recoveries"];
          var d = result_data[date]["Cumulative"]["Mortalities"];

          var e = result_data[date]["Cumulative"]["Cases"]["event"];
          var row = [ new Date(date),
                    (e) ? e : null , 
                    (c) ? c["cases"] : null, 
                    (a) ? a["cases"] : null , 
                    (r) ? r["cases"] : null , 
                    (d) ? d["cases"] : null
                    ];
          cumulative_data.push(row);
    
        }

        for (var d in result_data[date]["Daily"]) {
          var c = result_data[date]["Daily"]["Cases"];
          var a = result_data[date]["Daily"]["Active cases"];
          var r = result_data[date]["Daily"]["Recoveries"];
          var d = result_data[date]["Daily"]["Mortalities"];

          var e = result_data[date]["Daily"]["Cases"]["event"];
          var row = [ new Date(date),
                    (e) ? e : null , 
                    (c) ? c["cases"] : null, 
                    (a) ? a["cases"] : null , 
                    (r) ? r["cases"] : null , 
                    (d) ? d["cases"] : null
                    ];
          daily_data.push(row);
        }
    
    
      });


      var data = new google.visualization.DataTable();
      
      data.addColumn('date', 'Date');
      data.addColumn({ type: 'string', role: 'annotation' });
      data.addColumn('number', 'Confirmed');
      data.addColumn('number', 'Active');
      data.addColumn('number', 'Recovered');
      data.addColumn('number', 'Deaths');
      data.addRows(daily_data);


      var options = {

        'height': 500,
        chartArea: { left: 50, top: 30, height: '75%', width: "93%" },
        'legend': 'bottom',
        hAxis: {
          format: 'M/d',
          // title: 'Time'

        },
        vAxis: {
          // title: 'Popularity'
          format: 'short'
        },
        series: {
          // 1: {curveType: 'function'}
          0: { color: '#FF7335' },
          1: { color: '#EB5757' },
          2: { color: '#27AE60' },
          3: { color: '#2F80ED' }
        },
        annotations: {
          style: 'line',
          textStyle: {
            opacity: 0.5
          }
        }
      };
      var chart2 = new google.visualization.LineChart(document.getElementById('chart_daily'));
      chart2.draw(data, options);





      var data = new google.visualization.DataTable();
      data.addColumn('date', 'Date');
      data.addColumn({ type: 'string', role: 'annotation' });
      data.addColumn('number', 'Confirmed');
      data.addColumn('number', 'Active');
      data.addColumn('number', 'Recovered');
      data.addColumn('number', 'Deaths');
      data.addRows(cumulative_data);
      var options = {
        'height': 500,

        chartArea: { left: 50, top: 30, height: '75%', 'width': '93%' },
        'legend': 'bottom',
        pointSize: 4,
        hAxis: {
          format: 'M/d',
          // title: 'Time'

        },
        vAxis: {
          // title: 'Popularity'
          format: 'short'
        },
        series: {
          // 1: {curveType: 'function'}
          0: { color: '#FF7335' },
          1: { color: '#EB5757' },
          2: { color: '#27AE60' },
          3: { color: '#2F80ED' },
        },
        annotations: {
          style: 'line',
          textStyle: {
            opacity: 0.5
          }
        }
      };
      var chart = new google.visualization.LineChart(document.getElementById('chart_cumulative'));
      chart.draw(data, options);




    }










    google.charts.load('current', { 'packages': ['treemap'] });
    google.charts.setOnLoadCallback(drawTreeChart);








    
    function drawTreeChart() {



      var helper = {};
      var daily_bycity = daily_dataset.reduce(function (r, value) {

        var key = value["attributes"]["Name_Eng"];

        var confirmed_value = value["attributes"]["Confirmed"];
        var active_value = value["attributes"]["Active"];
        var recovered_value = value["attributes"]["Recovered"];
        var deaths_value = value["attributes"]["Deaths"];

        if (!helper[key]) {
          // helper[key] = //Object.assign({}, value["attributes"]); // create a copy of o
          helper[key] = { Region:regions[key],City: key, Confirmed: confirmed_value, Active: active_value, Recovered: recovered_value, Deaths: deaths_value };
          r.push(helper[key]);
        } else {
          helper[key].Confirmed += confirmed_value;
          helper[key].Active += active_value;
          helper[key].Recovered += recovered_value;
          helper[key].Deaths += deaths_value;
          //   helper[key].instances += o.instances;
        }
        return r;
      }, []);




    

      var dt_confirmed = [['City', 'Parent', 'Value'], ['City (Confirmed Cases)', null, 0]];
      daily_bycity.forEach(function myFunction(item, index, arr) {
        var row = [item["City"], "City (Confirmed Cases)", item["Confirmed"]];
        dt_confirmed.push(row);
      });
      var data_confirmed = new google.visualization.arrayToDataTable(dt_confirmed);


      var view_confirmed = new google.visualization.DataView(data_confirmed);
      view_confirmed.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_confirmed.getColumnLabel(0),
        type: data_confirmed.getColumnType(0)
      }, 1, 2]);

      tree_confirmed = new google.visualization.TreeMap(document.getElementById('tree_confirmed'));
      google.visualization.events.addListener(tree_confirmed, 'select', function () {
        tree_confirmed.setSelection([]);
      });
      tree_confirmed.draw(view_confirmed, {
        height: 500,
        minColor: '#ededed',
        midColor: '#ffa882',
        maxColor: '#FF7335',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipConfirmed,
        useWeightedAverageForAggregation: false
      });
      function showTooltipConfirmed(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_confirmed.getValue(row, 0) +
          '</b>, ' + data_confirmed.getValue(row, 2);
      }




     









      var dt_active = [['City', 'Parent', 'Value'], ['City (Active Cases)', null, 0]];
      daily_bycity.forEach(function myFunction(item, index, arr) {
        var row = [item["City"], "City (Active Cases)", item["Active"]];
        dt_active.push(row);
      });

      var data_active = new google.visualization.arrayToDataTable(dt_active);


      var view_active = new google.visualization.DataView(data_active);
      view_active.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_active.getColumnLabel(0),
        type: data_active.getColumnType(0)
      }, 1, 2]);



      tree_active = new google.visualization.TreeMap(document.getElementById('tree_active'));
      google.visualization.events.addListener(tree_active, 'select', function () {
        tree_active.setSelection([]);
      });
      tree_active.draw(view_active, {
        height: 500,
        minColor: '#ededed',
        midColor: '#ffa882',
        maxColor: '#EB5757',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipActive,
        useWeightedAverageForAggregation: false
      });




      function showTooltipActive(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_active.getValue(row, 0) +
          '</b>, ' + data_active.getValue(row, 2);
      }









      var dt_recovered = [['City', 'Parent', 'Value'], ['City (Recovered Cases)', null, 0]];
      daily_bycity.forEach(function myFunction(item, index, arr) {
        var row = [item["City"], "City (Recovered Cases)", Math.round(item["Recovered"])];
        dt_recovered.push(row);
      });

      var data_recovered = new google.visualization.arrayToDataTable(dt_recovered);


      var view_recovered = new google.visualization.DataView(data_recovered);
      view_recovered.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_recovered.getColumnLabel(0),
        type: data_recovered.getColumnType(0)
      }, 1, 2]);



      tree_recovered = new google.visualization.TreeMap(document.getElementById('tree_recovered'));
      google.visualization.events.addListener(tree_recovered, 'select', function () {
        tree_recovered.setSelection([]);
      });
      tree_recovered.draw(view_recovered, {
        height: 500,
        minColor: '#ededed',
        midColor: '#4bd786',
        maxColor: '#27AE60',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipRecovered,
        useWeightedAverageForAggregation: false
      });




      function showTooltipRecovered(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_recovered.getValue(row, 0) +
          '</b>, ' + data_recovered.getValue(row, 2);
      }



      var dt_deaths = [['City', 'Parent', 'Value'], ['City (Death Cases)', null, 0]];
      daily_bycity.forEach(function myFunction(item, index, arr) {
        var row = [item["City"], "City (Death Cases)", Math.round(item["Deaths"])];
        dt_deaths.push(row);
      });

      var data_deaths = new google.visualization.arrayToDataTable(dt_deaths);


      var view_deaths = new google.visualization.DataView(data_deaths);
      view_deaths.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_deaths.getColumnLabel(0),
        type: data_deaths.getColumnType(0)
      }, 1, 2]);



      tree_deaths = new google.visualization.TreeMap(document.getElementById('tree_deaths'));
      google.visualization.events.addListener(tree_deaths, 'select', function () {
        tree_deaths.setSelection([]);
      });
      tree_deaths.draw(view_deaths, {
        height: 500,
        minColor: '#ededed',
        midColor: '#75abf3',
        maxColor: '#2F80ED',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipDeaths,
        useWeightedAverageForAggregation: false
      });




      function showTooltipDeaths(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_deaths.getValue(row, 0) +
          '</b>, ' + data_deaths.getValue(row, 2);
      }












      var helper = {};
      var groupByRegion = daily_bycity.reduce(function (r, value) {

var key = value['Region'];
// console.log(key);

var confirmed_value = value["Confirmed"];
var active_value = value["Active"];
var recovered_value = value["Recovered"];
var deaths_value = value["Deaths"];

if (!helper[key]) {
// console.log("key******");
// console.log(key);

  // helper[key] = //Object.assign({}, value["attributes"]); // create a copy of o
  helper[key] = { Region:key, Confirmed: confirmed_value, Active: active_value, Recovered: recovered_value, Deaths: deaths_value };
  r.push(helper[key]);
} else {
  helper[key].Confirmed += confirmed_value;
  helper[key].Active += active_value;
  helper[key].Recovered += recovered_value;
  helper[key].Deaths += deaths_value;
  //   helper[key].instances += o.instances;
}
return r;
}, []);



      var dt_confirmed = [['Region', 'Parent', 'Value'], ['Region (Confirmed Cases)', null, 0]];
      groupByRegion.forEach(function myFunction(item, index, arr) {
        var row = [item["Region"], 'Region (Confirmed Cases)', item["Confirmed"]];
        dt_confirmed.push(row);
      });
      var data_confirmed = new google.visualization.arrayToDataTable(dt_confirmed);


      var view_confirmed = new google.visualization.DataView(data_confirmed);
      view_confirmed.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_confirmed.getColumnLabel(0),
        type: data_confirmed.getColumnType(0)
      }, 1, 2]);

      tree_confirmed1 = new google.visualization.TreeMap(document.getElementById('tree_confirmed1'));
      google.visualization.events.addListener(tree_confirmed1, 'select', function () {
        tree_confirmed1.setSelection([]);
      });
      tree_confirmed1.draw(view_confirmed, {
        height: 500,
        minColor: '#ededed',
        midColor: '#ffa882',
        maxColor: '#FF7335',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipConfirmed1,
        useWeightedAverageForAggregation: false
      });
      function showTooltipConfirmed1(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_confirmed.getValue(row, 0) +
          '</b>, ' + data_confirmed.getValue(row, 2);
      }








      var dt_active = [['Region', 'Parent', 'Value'], ['Region (Active Cases)', null, 0]];
      groupByRegion.forEach(function myFunction(item, index, arr) {
        var row = [item["Region"], "Region (Active Cases)", item["Active"]];
        dt_active.push(row);
      });

      var data_active = new google.visualization.arrayToDataTable(dt_active);


      var view_active = new google.visualization.DataView(data_active);
      view_active.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + ')'
            };
          }

          return rowValue;
        },
        label: data_active.getColumnLabel(0),
        type: data_active.getColumnType(0)
      }, 1, 2]);



      tree_active1 = new google.visualization.TreeMap(document.getElementById('tree_active1'));
      google.visualization.events.addListener(tree_active1, 'select', function () {
        tree_active.setSelection([]);
      });
      tree_active1.draw(view_active, {
        height: 500,
        minColor: '#ededed',
        midColor: '#ffa882',
        maxColor: '#EB5757',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipActive1,
        useWeightedAverageForAggregation: false
      });




      function showTooltipActive1(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_active.getValue(row, 0) +
          '</b>, ' + data_active.getValue(row, 2);
      }













      var dt_recovered = [['Region', 'Parent', 'Value'], ['Region (Recovered Percentage)', null, 0]];
      groupByRegion.forEach(function myFunction(item, index, arr) {
        var row = [item["Region"], "Region (Recovered Percentage)", Math.round(item["Recovered"]*100/item["Confirmed"])];
        dt_recovered.push(row);
      });

      var data_recovered = new google.visualization.arrayToDataTable(dt_recovered);


      var view_recovered = new google.visualization.DataView(data_recovered);
      view_recovered.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + '%)'
            };
          }

          return rowValue;
        },
        label: data_recovered.getColumnLabel(0),
        type: data_recovered.getColumnType(0)
      }, 1, 2]);



      tree_recovered1 = new google.visualization.TreeMap(document.getElementById('tree_recovered1'));
      google.visualization.events.addListener(tree_recovered1, 'select', function () {
        tree_recovered1.setSelection([]);
      });
      tree_recovered1.draw(view_recovered, {
        height: 500,
        minColor: '#ededed',
        midColor: '#4bd786',
        maxColor: '#27AE60',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipRecovered1,
        useWeightedAverageForAggregation: false
      });




      function showTooltipRecovered1(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_recovered.getValue(row, 0) +
          '</b>, ' + data_recovered.getValue(row, 2)+'%';
      }



      var dt_deaths = [['Region', 'Parent', 'Value'], ['Region (Death Percentage)', null, 0]];
      groupByRegion.forEach(function myFunction(item, index, arr) {
        var row = [item["Region"], "Region (Death Percentage)", (item["Deaths"]*100/item["Confirmed"])];
        dt_deaths.push(row);
      });

      var data_deaths = new google.visualization.arrayToDataTable(dt_deaths);


      var view_deaths = new google.visualization.DataView(data_deaths);
      view_deaths.setColumns([{
        calc: function (dt, row) {
          var rowValue;

          if (row === 0) {
            rowValue = dt.getValue(row, 0);  // value for global
          } else {
            // change display value by changing formatted value
            rowValue = {
              v: dt.getValue(row, 0),
              f: dt.getValue(row, 0) + ' (' + dt.getFormattedValue(row, 2) + '%)'
            };
          }

          return rowValue;
        },
        label: data_deaths.getColumnLabel(0),
        type: data_deaths.getColumnType(0)
      }, 1, 2]);



      tree_deaths1 = new google.visualization.TreeMap(document.getElementById('tree_deaths1'));
      google.visualization.events.addListener(tree_deaths1, 'select', function () {
        tree_deaths1.setSelection([]);
      });
      tree_deaths1.draw(view_deaths, {
        height: 500,
        minColor: '#ededed',
        midColor: '#75abf3',
        maxColor: '#2F80ED',
        headerHeight: 15,
        fontColor: 'black',
        // showScale: true
        generateTooltip: showTooltipDeaths1,
        useWeightedAverageForAggregation: false
      });




      function showTooltipDeaths1(row, size, value) {
        return '<div style="background:#fd9; padding:5px; border-style:solid">' +
          '<span><b>' + data_deaths.getValue(row, 0) +
          '</b>, ' + data_deaths.getValue(row, 2)+'%';
      }









    }








    function show_map() {
      if (document.getElementById('select-map-confirmed').checked) {
        document.getElementById('active-map').style.height = 0;
        document.getElementById('recovered-map').style.height = 0;
        document.getElementById('deaths-map').style.height = 0;
        document.getElementById('active-map-region').style.height = 0;
        document.getElementById('recovered-map-region').style.height = 0;
        document.getElementById('deaths-map-region').style.height = 0;



          document.getElementById('tree_active').style.display = "none";
          document.getElementById('tree_recovered').style.display = "none";
          document.getElementById('tree_deaths').style.display = "none";
          document.getElementById('tree_active1').style.display = "none";
          document.getElementById('tree_recovered1').style.display = "none";
          document.getElementById('tree_deaths1').style.display = "none";

        if (document.getElementById('select-view-city').checked) {
          document.getElementById('tree_confirmed').style.display = "block";
          document.getElementById('tree_confirmed1').style.display = "none";

          document.getElementById('confirmed-map').style.height = '500px';
          document.getElementById('confirmed-map-region').style.height = 0;


        }else if (document.getElementById('select-view-region').checked) {
          document.getElementById('tree_confirmed').style.display = "none";
          document.getElementById('tree_confirmed1').style.display = "block";

          document.getElementById('confirmed-map').style.height = 0;
          document.getElementById('confirmed-map-region').style.height = '500px';

        }
        
      }
      else if (document.getElementById('select-map-active').checked) {

        document.getElementById('confirmed-map').style.height = 0;
        document.getElementById('recovered-map').style.height = 0;
        document.getElementById('deaths-map').style.height = 0;
        document.getElementById('confirmed-map-region').style.height = 0;
        document.getElementById('recovered-map-region').style.height = 0;
        document.getElementById('deaths-map-region').style.height = 0;




        document.getElementById('tree_confirmed').style.display = "none";
          document.getElementById('tree_recovered').style.display = "none";
          document.getElementById('tree_deaths').style.display = "none";
          document.getElementById('tree_confirmed1').style.display = "none";
          document.getElementById('tree_recovered1').style.display = "none";
          document.getElementById('tree_deaths1').style.display = "none";

        if (document.getElementById('select-view-city').checked) {
          document.getElementById('tree_active').style.display = "block";
          document.getElementById('tree_active1').style.display = "none";
        document.getElementById('active-map').style.height = '500px';
        document.getElementById('active-map-region').style.height = 0;

        }else if (document.getElementById('select-view-region').checked) {
          document.getElementById('tree_active').style.display = "none";
          document.getElementById('tree_active1').style.display = "block";

        document.getElementById('active-map').style.height = 0;
        document.getElementById('active-map-region').style.height = '500px';
        }
      }
      else if (document.getElementById('select-map-recovered').checked) {
        document.getElementById('confirmed-map').style.height = 0;
        document.getElementById('active-map').style.height = 0;
        document.getElementById('deaths-map').style.height = 0;

        document.getElementById('confirmed-map-region').style.height = 0;
        document.getElementById('active-map-region').style.height = 0;
        document.getElementById('deaths-map-region').style.height = 0;

        document.getElementById('tree_confirmed').style.display = "none";
        document.getElementById('tree_confirmed1').style.display = "none";
        document.getElementById('tree_active').style.display = "none";
        document.getElementById('tree_active1').style.display = "none";
        document.getElementById('tree_deaths').style.display = "none";
        document.getElementById('tree_deaths1').style.display = "none";


        if (document.getElementById('select-view-city').checked) {
        document.getElementById('tree_recovered').style.display = "block";
        document.getElementById('tree_recovered1').style.display = "none";
        document.getElementById('recovered-map').style.height = '500px';
        document.getElementById('recovered-map-region').style.height = 0;



        }else if (document.getElementById('select-view-region').checked) {

        document.getElementById('tree_recovered').style.display = "none";
        document.getElementById('tree_recovered1').style.display = "block";

        document.getElementById('recovered-map').style.height = 0;
        document.getElementById('recovered-map-region').style.height = '500px';
        }


      }
      else if (document.getElementById('select-map-deaths').checked) {
        document.getElementById('confirmed-map').style.height = 0;
        document.getElementById('active-map').style.height = 0;
        document.getElementById('recovered-map').style.height = 0;

        document.getElementById('confirmed-map-region').style.height = 0;
        document.getElementById('active-map-region').style.height = 0;
        document.getElementById('recovered-map-region').style.height = 0;


        document.getElementById('tree_confirmed').style.display = "none";
        document.getElementById('tree_active').style.display = "none";
        document.getElementById('tree_recovered').style.display = "none";
        document.getElementById('tree_confirmed1').style.display = "none";
        document.getElementById('tree_active1').style.display = "none";
        document.getElementById('tree_recovered1').style.display = "none";




        if (document.getElementById('select-view-city').checked) {
        document.getElementById('tree_deaths').style.display = "block";
        document.getElementById('tree_deaths1').style.display = "none";
        document.getElementById('deaths-map').style.height = '500px';
        document.getElementById('deaths-map-region').style.height = 0;



        }else if (document.getElementById('select-view-region').checked) {

        document.getElementById('tree_deaths').style.display = "none";
        document.getElementById('tree_deaths1').style.display = "block";
        document.getElementById('deaths-map').style.height = 0;
        document.getElementById('deaths-map-region').style.height = '500px';
        
        }
      }
    }
  </script>
</head>

<body onload="javascript:show_map();">

  <div class="container">
    <div class="row">
      <h2>COVID-19 Cases in Saudi Arabia</h2>
    </div>
    <div class="row">
      <span class="meta-label">Data Source: </span>
      <span class="meta">
        <a href="https://datasource.kapsarc.org/explore/dataset/saudi-arabia-coronavirus-disease-covid-19-situation/"
          target="_blank">
          Ministry of Health
        </a>
      </span>
      <!-- <span class="meta-label">Last Updated: </span> -->
      <!-- <span class="meta"> **</span> -->


    </div>
    <!-- <div class="row" style="margin-top: 25px;">
    <div class="col-md-3" style="float: center;">

      <div class="text-right">Confirmed Cases Overview</div>
    </div>
    <div class="col-md-9">
      <svg width="100%" height="20px" xmlns="http://www.w3.org/2000/svg" version="1.1"> 
        <line class="stroke-3" x1="40" x2="250" y1="100" y2="100" style=" stroke-linecap: round;"/>

        
        <line x1="0" y1="12" x2="80%" y2="12" style="stroke-linecap: round;stroke: #EB5757; stroke-width: 12 ;border-radius: 10px;"></line>
        <text x="40%" y="13" dominant-baseline="middle" text-anchor="middle" style="fill: white; font-size:10">80%</text>
        <line x1="80%" y1="12" x2="93%" y2="12" style="stroke: green; stroke-width: 12"></line>
        <text x="87%" y="13" dominant-baseline="middle" text-anchor="middle" style="fill: white; font-size:10">13%</text>
      </svg>
    </div>
    
  </div> -->
    <div class="card" style="padding: 10px 0 0 0;">
      <div class="row">
        <div class="col-md-3">
          <div id="total-confirmed" class="text-center">
          </div>
          <div class="text-center">
            Total Confirmed Cases

          </div>
        </div>
        <div class="col-md-3 text-center">
          <div id="total-active">
          </div>
          <div class="">
            Active Cases

          </div>
        </div>
        <div class="col-md-3 text-center">
          <div id="total-recovered">
          </div>
          <div class="">
            Recovered cases
          </div>
        </div>
        <div class="col-md-3 text-center">
          <div id="total-deaths">
          </div>
          <div class="">
            Death cases

          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
        </div>


        <div class="col-md-9">
          <div id="cases-percentage"></div>

          </svg>

        </div>

      </div>
    </div>


    <div class="row" style="margin: 10px 0;">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-12 card">
            <div class="">
              Total Cases - Cumulative
            </div>
            <div id="chart_cumulative"></div>
          </div>
          <div class="col-md-12 card">
            <div class="">
              Cases - Daily
            </div>
            <div id="chart_daily"></div>
          </div>

        </div>

      </div>
      <!-- <div class="col-md-2">filters</div>-->
    </div>

    <!-- <div class="col-md-6">
      <div class="card" id="map" ></div>
    </div> -->
<div class="row">
    <!-- <div class="col-md-5">
    <b>Cases:</b>
    <input type="radio" onclick="javascript:show_map();" id="select-map-confirmed" name="map_indicator"
      value="confirmed" checked><label> Confirmed</label>
    <input type="radio" onclick="javascript:show_map();" id="select-map-active" name="map_indicator"
      value="active"><label> Active</label>
    <input type="radio" onclick="javascript:show_map();" id="select-map-recovered" name="map_indicator"
      value="recovered"><label> Recovered</label>
    <input type="radio" onclick="javascript:show_map();" id="select-map-deaths" name="map_indicator"
      value="deaths"><label> Deaths</label>
    </div> -->
<div class="col-md-5">
    <!-- <b>Veiw by:</b> 
    <input type="radio" onclick="javascript:show_map();" id="select-view-city" name="view_indicator"
      value="city" checked><label> City</label>
    <input type="radio" onclick="javascript:show_map();" id="select-view-region" name="view_indicator"
      value="region" ><label> Region</label>
    </div>
    </div> -->



    <!-- <div class="card">
      <div class="row">
        <div class="col-md-8">
          <div>
            <div class="map" id="confirmed-map"> </div>
            <div class="map" id="active-map"></div>
            <div class="map" id="recovered-map"></div>
            <div class="map" id="deaths-map"></div>

            <div class="map" id="confirmed-map-region"> </div>
            <div class="map" id="active-map-region"></div>
            <div class="map" id="recovered-map-region"></div>
            <div class="map" id="deaths-map-region"></div>

          </div>
        </div>
        <div class="col-md-4">
          <div>
            <div id="tree_confirmed1"></div>
            <div id="tree_active1"></div>
            <div id="tree_recovered1"></div>
            <div id="tree_deaths1"></div>
            <div id="tree_confirmed"></div>
            <div id="tree_active"></div>
            <div id="tree_recovered"></div>
            <div id="tree_deaths"></div>
          </div>
        </div>
      </div>
    </div> -->


  </div>


  <!-- <div id="chart_div1" style="width: 900px; height: 500px;"></div>  -->
  <!-- <div id="visualization" ></div> -->

</body>

</html>
